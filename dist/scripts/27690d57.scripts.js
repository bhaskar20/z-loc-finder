"use strict";function mainCtrl(a,b,c,d){function e(b){var d={Accept:"application/json","user-key":"1d6e387a44a449b655310a8e6dd35170"},e="https://developers.zomato.com/api/v2.1/geocode?";e+="lat="+b.lat()+"&lon="+b.lng(),c.get(e,{headers:d}).then(function(b){a.nearbyRes=b.data.nearby_restaurants,f(a.nearbyRes)},function(a){g(),window.alert("No Restraunts found for this location")})}function f(b){function c(a){var b=a;i.addListener("click",function(){k(b)})}g();for(var d=0;d<b.length;d++){var e=b[d].restaurant,f="https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png",h=new google.maps.LatLng(Number(e.location.latitude),Number(e.location.longitude)),i=new google.maps.Marker({position:h,icon:f,map:a.map,title:e.name+" (click me for details)"});c(e),l.push(i)}for(var j=new google.maps.LatLngBounds,d=0;d<l.length;d++)j.extend(l[d].getPosition());j.extend(a.marker.getPosition()),a.map.fitBounds(j)}function g(){for(var a=0;a<l.length;a++)l[a].setMap(null);l=[]}function h(b){a.marker&&a.marker.setMap(null);var c=new google.maps.LatLng(Number(b.lat),Number(b.lng));a.marker=new google.maps.Marker({position:c,map:a.map}),a.map.panTo(c),a.map.setZoom(12),e(c)}function i(a){var b=a.split(" ");return b.join("+")}function j(){function b(b){var c=new google.maps.LatLng(Number(b.coords.latitude),Number(b.coords.longitude));a.marker=new google.maps.Marker({position:c,map:a.map}),a.map.panTo(c),a.map.setZoom(12),e(c)}navigator.geolocation&&navigator.geolocation.getCurrentPosition(b)}function k(a){var b=d.open({animation:!0,templateUrl:"views/restInfo.html",controller:"restInfoCtrl",backdrop:"static",size:"lg",resolve:{info:function(){return a}}});b.result.then(function(a){},function(){})}var l=[];a.nearbyRes=[],b.getMap().then(function(b){a.map=b,j()}),a.changeUserRestPos=function(b){a.marker&&a.marker.setMap(null),console.log(b.latLng.lat()),console.log(b.latLng.lng()),a.marker=new google.maps.Marker({position:b.latLng,map:a.map}),a.map.panTo(b.latLng),a.map.setZoom(12),e(b.latLng)},a.search=function(){var b="https://maps.googleapis.com/maps/api/geocode/json?address=",d=i(a.searchText);b+=d,b+="&key=AIzaSyC9eGxd2dRKtP8mU2dzFTaOC4wmdvC14h8",c.get(b).then(function(a){0==a.data.results.length?window.alert("Unable to get location"):h(a.data.results[0].geometry.location)},function(a){window.alert("Unable to get location")})}}function restInfoCtrl(a,b,c,d){a.info=d,a.orderNow=function(a){window.location.href=a},a.close=function(){b.close()}}angular.module("myApp",["ui.bootstrap","ngCookies","ngResource","ngSanitize","ngRoute","ngAnimate","ngMap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"mainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("myApp").controller("mainCtrl",mainCtrl),mainCtrl.$inject=["$scope","NgMap","$http","$uibModal"],angular.module("myApp").controller("restInfoCtrl",restInfoCtrl),restInfoCtrl.$inject=["$scope","$uibModalInstance","$location","info"];